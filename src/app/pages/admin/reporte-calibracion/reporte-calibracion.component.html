<div class="relative overflow-x-auto">
      <app-title titulo="REPORTE DE AVANCE DE CALIBRACIÓN"></app-title>
      <div class="max-w-[22rem] mx-auto p-4 bg-white rounded-lg shadow-md border border-gray-300 rounded-md mb-6">
        <div class="flex items-center justify-center">
            <div *ngIf="calendarData == undefined" style="height: 53px; margin-right: 0.5rem ">
                <mat-form-field>
                  <mat-select placeholder="Periodo"></mat-select>
                </mat-form-field>
              </div> 
              <div *ngIf="calendarData != undefined" style=" height: 53px; margin-right: 0.5rem ">
                <mat-form-field>
                  <mat-select placeholder="Periodo" [(ngModel)]="Periodo">
                    <mat-option *ngFor="let item of calendarData.registros" [value]="item.vCodigo">
                      {{item.vNombre}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div> 
            <button style="width: 107.42px;" (click)="FilterData()"  class="items-center justify-center py-2 bg-blue-600 text-white rounded-md flex items-center hover:bg-blue-700 ">
              <svg class="w-5 h-5 text-white"  xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                <path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="m21 21-3.5-3.5M17 10a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"/>
              </svg>                
              Buscar
            </button>
        </div>
      </div>
      <div *ngIf="Activatetable" class="relative overflow-x-auto">
        <table class="w-full text-sm text-left rtl:text-right text-gray-500 border solid">
            <thead class="text-xs text-gray-700 uppercase bg-gray-5">
                <tr>
                    <th scope="col" class="px-6 py-3 border" style="width: 2rem;">
                        <!-- Columna para la flecha -->
                    </th>
                    <th scope="col" class="px-6 py-3 border" style="width: 8rem;">
                        Foto
                    </th>
                    <th scope="col" class="px-6 py-3 border" style="width: 5.9rem;">
                        COD. FICHA
                    </th>
                    <th scope="col" class="px-6 py-3 border" style="width: 35rem;">
                        APELLIDOS Y NOMBRES
                    </th>
                    <th scope="col" class="px-6 py-3 border" style="width: 8.5rem;">
                        UNIDAD ORGÁNICA
                    </th>
                    <th scope="col" class="px-6 py-3 border" style="width: 6.8rem;">
                        COD. PUESTO
                    </th>
                    <th scope="col" class="px-6 py-3 border text-wrap" style="width: 35rem;">
                        PUESTO
                    </th>
                    <th scope="col" class="px-6 py-3 border text-center" style="width: 10rem;">
                        Fecha límite
                    </th>
                    <th scope="col" class="px-6 py-3 border" style="width: 10rem;">
                        ESTADO
                    </th>
                    <th scope="col" class="px-6 py-3 border" style="width: 10rem;">
                        Acciones
                    </th>
                </tr>
            </thead>
            <tbody>
                <ng-container *ngFor="let item of DataList.registros">
                    <tr class="border hover:bg-gray-100 cursor-pointer">
                        <td class="px-2 py-4 text-center" (click)="toggleRowExpansion(item.evaluado.codigoFicha)">
                            <span class="inline-block transition-transform duration-200" [ngClass]="{'rotate-180': isRowExpanded(item.evaluado.codigoFicha)}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down h-4 w-4" data-id="57"><path d="m6 9 6 6 6-6"></path></svg>
                            </span>
                        </td>
                        <th class="px-6 py-4 text-black border">
                            <img class="w-20 h-20" 
                                 [src]="item.evaluado.foto" 
                                 crossorigin="anonymous" (error)="onImgError($event)"
                                 alt="Foto">
                        </th>         
                        <th class="px-6 py-4 text-gray-900 whitespace-nowrap">
                            <div class="text-base font-semibold">{{removeLeadingZeros(item.evaluado.codigoFicha)}}</div>
                        </th>
                        <td class="px-6 py-4 text-black border">
                            {{item.evaluado.apellidosNombres}}
                        </td>
                        <td class="px-6 py-4 text-black border">
                            {{item.evaluado.unidadOrganica}}
                        </td>
                        <td class="px-6 py-4 text-black border">
                            {{item.evaluado.codigoPuesto}}
                        </td>
                        <td class="px-6 py-4 text-black border">
                            {{item.evaluado.nombrePuesto}}
                        </td>
                        <td [ngClass]="getStatusClass(item.fechaPlazo,item.estadoCalibracion)"
                            class="px-6 py-4 text-black border text-center">
                            {{ReturnFormatedStatusDate(item.fechaPlazo).formattedDate}}
                        </td>          
                        <td class="px-6 py-4 text-black border">
                            <div *ngIf="item.estadoCalibracion" class="flex items-center">
                                <span class="badgegreen bg-green-500">CALIBRADO</span>                   
                            </div>
                            <div *ngIf="!item.estadoCalibracion" class="flex items-center">
                                <span class="badgered bg-red-500">NO CALIBRADO</span>                           
                            </div>   
                        </td>
                        <td class="px-6 py-4">
                            <div>
                                <button type="button" *ngIf="item.estadoCalibracion" [routerLink]="['/home/ver-progreso-calibracion',item.evaluador.codigoFicha,this.Periodo,item.idEvaluacion]" class="text-white bg-green-500 hover:bg-green-600 font-medium rounded-lg text-sm px-2.5 py-2.5 w-full">Ver resultados</button>
                                <button type="button" *ngIf="!item.estadoCalibracion && !ReturnFormatedStatusDate(item.fechaPlazo).isPast" (click)="SendNotification(item.evaluador.apellidosNombres,item.idCalibracion)" class="text-white bg-blue-500 hover:bg-blue-600 font-medium rounded-lg text-sm px-2.5 py-2.5 w-full">Notificar evaluador</button>
                                <button type="button" *ngIf="!item.estadoCalibracion && ReturnFormatedStatusDate(item.fechaPlazo).isPast" class="text-white bg-gray-500 font-medium rounded-lg text-sm px-2.5 py-2.5 w-full">Calibración expirada</button>
                            </div>                    
                        </td>
                    </tr>
                    <tr *ngIf="isRowExpanded(item.evaluado.codigoFicha)" class="bg-gray-50">
                        <td colspan="10" class="px-6 py-4 text-black border">
                            <div class="grid bg-gray-200 p-2 rounded-md">
                                <div>
                                    <strong>Ficha del evaluador: </strong> {{removeLeadingZeros(item.evaluador.codigoFicha)}}
                                </div>
                                <div>
                                    <strong>Nombres del evaluador: </strong> {{item.evaluador.apellidosNombres}}
                                </div>
                                <div>
                                    <strong>Administrador que autorizó la calibración: </strong> {{item.admin.apellidosNombres}}
                                </div>
                                <div>
                                    <strong>Registro de autorización: </strong> {{ReturnFormatedDate(item.fechaRegistro)}}
                                </div>                        
                            </div>
                        </td>
                    </tr>
                </ng-container>
            </tbody>
        </table>
      </div>